$(function () {
	jQuery.post('/tcweb/elevator/cseletjMapEcharts', function(data){ 
        data = eval(data);//POST方法必加，ajax方法自动处理了 
        var mapValueData = data.tjMapEcharts;            
        drawMap(mapValueData);
	   }, 'json'); 
}); 
function drawMap(mapValueData){	
    echarts.registerMap('长沙', { "type": "FeatureCollection", "features": [{ "type": "Feature", "properties": { "name": "长沙县" }, "geometry": { "type": "MultiPolygon", "coordinates": [[[[113.297345, 28.0438430000001], [113.320343046875, 28.039790265625], [113.302779570313, 28.0311452460938], [113.297345, 28.0438430000001]]], [[[113.297345, 28.0438430000001], [113.274774199219, 28.0499611640625], [113.229959746094, 28.0776979804688], [113.233690214844, 28.0560280585937], [113.212345, 28.0597048164063], [113.202345, 28.0579811835938], [113.182122832031, 28.0614626289063], [113.173079863281, 28.0281081367188], [113.167345, 28.013843], [113.152276640625, 28.0022121406251], [113.14298953125, 27.95819846875], [113.131549101563, 27.939233625], [113.133140898438, 27.9284499335938], [113.12158328125, 27.9094875312501], [113.087345, 27.953843], [113.071500273438, 27.9789870429688], [113.089012480469, 27.9935353828125], [113.047728300781, 28.0183815742188], [113.015047636719, 27.9790383125001], [112.997345, 27.973843], [112.96408328125, 27.9905226875], [112.957345, 28.0038430000001], [112.957345, 28.013843], [112.947345, 28.013843], [112.943985625, 28.030483625], [112.937345, 28.0438430000001], [112.953985625, 28.047202375], [112.971954375, 28.0614748359376], [112.987298613281, 28.0539821601563], [112.997345, 28.0738430000001], [113.013985625, 28.070483625], [113.031954375, 28.0562111640626], [113.043336210938, 28.0617678046875], [113.05279421875, 28.043071515625], [113.060704375, 28.070483625], [113.075269804688, 28.0778517890626], [113.0674621875, 28.093843], [113.079671660156, 28.1188430000001], [113.064969511719, 28.1489455390626], [113.077345, 28.173843], [113.087345, 28.173843], [113.110335722656, 28.1780397773438], [113.097345, 28.183843], [113.106246367188, 28.2070021796875], [113.047345, 28.223843], [113.053035917969, 28.2389870429688], [113.026199980469, 28.2762770820313], [113.052894316406, 28.298452375], [113.051803007813, 28.309165265625], [113.0810559375, 28.360239484375], [113.059866972656, 28.35808128125], [113.022806425781, 28.3793044257813], [112.981883574219, 28.3883815742188], [112.977345, 28.393843], [112.984154082031, 28.3980373359375], [112.98048953125, 28.4098024726563], [113.011844511719, 28.4204885078126], [113.022215605469, 28.4645192695313], [113.044366484375, 28.478169171875], [113.037345, 28.4938430000001], [113.048631621094, 28.5025563789063], [113.064329863281, 28.5228908515626], [113.122821074219, 28.4998976875001], [113.13170046875, 28.4781984687501], [113.157144804688, 28.46948753125], [113.193577910156, 28.5585085273438], [113.181549101563, 28.5784523750001], [113.183084746094, 28.588843], [113.181226835938, 28.60140159375], [113.20298953125, 28.61819846875], [113.21170046875, 28.6394875312501], [113.22298953125, 28.64819846875], [113.227345, 28.663843], [113.233170195313, 28.6596681953126], [113.250484648438, 28.6355104804687], [113.279386015625, 28.6412233710938], [113.331839628906, 28.6196681953126], [113.353170195313, 28.6280178046875], [113.367503691406, 28.6480178046875], [113.414124785156, 28.6328493476563], [113.4057825, 28.590630109375], [113.4589465625, 28.6011354804688], [113.493170195313, 28.5596681953125], [113.497345, 28.543843], [113.49271609375, 28.5184719062501], [113.4019153125, 28.4791896796876], [113.403204375, 28.4631496406251], [113.361229277344, 28.4444216132813], [113.328912382813, 28.416577375], [113.333116484375, 28.3642458320313], [113.319500761719, 28.3043166328125], [113.30197390625, 28.2892140937501], [113.283460722656, 28.2477272773438], [113.261693144531, 28.2289723945313], [113.27271609375, 28.2092140937501], [113.283038359375, 28.1860866523438], [113.367860136719, 28.1929030585938], [113.34271609375, 28.1712404609375], [113.364215117188, 28.1569850898438], [113.401146269531, 28.1599513984375], [113.414461699219, 28.13608909375], [113.33271609375, 28.06847190625], [113.309722929688, 28.0582106757813], [113.297345, 28.0438430000001]]]] } }, { "type": "Feature", "properties": { "name": "开福区" }, "geometry": { "type": "MultiPolygon", "coordinates": [[[[113.022806425781, 28.3793044257813], [113.059866972656, 28.35808128125], [113.0810559375, 28.360239484375], [113.051803007813, 28.309165265625], [113.052894316406, 28.298452375], [113.026199980469, 28.2762770820313], [113.053035917969, 28.2389870429688], [113.047345, 28.223843], [112.999888945313, 28.2212990546875], [112.984801054688, 28.2063869453125], [112.967345, 28.203843], [112.963985625, 28.260483625], [112.957345, 28.2738430000001], [112.943531523438, 28.3000295234375], [112.905191679688, 28.3445900703125], [112.943531523438, 28.3576564765626], [112.951158476563, 28.3800295234375], [112.977345, 28.393843], [112.981883574219, 28.3883815742188], [113.022806425781, 28.3793044257813]]]] } }, { "type": "Feature", "properties": { "name": "宁乡县" }, "geometry": { "type": "MultiPolygon", "coordinates": [[[[112.704832792969, 28.333843], [112.701678496094, 28.3084841132813], [112.71334109375, 28.2886428046875], [112.701790800781, 28.2793971992188], [112.69072390625, 28.2158010078125], [112.634547148438, 28.1921291328125], [112.622899199219, 28.1382888007813], [112.602899199219, 28.1222731757813], [112.616378203125, 28.116235578125], [112.642738066406, 28.1195143867188], [112.693836699219, 28.0821877265625], [112.759251738281, 28.0903249335937], [112.772899199219, 28.0793971992188], [112.777345, 28.0738430000001], [112.769400664063, 28.0698244453126], [112.777345, 28.053843], [112.767345, 28.053843], [112.767345, 28.0438430000001], [112.767345, 28.033843], [112.777345, 28.033843], [112.761429472656, 27.9997585273438], [112.752838164063, 27.96628440625], [112.720716582031, 27.9197585273438], [112.681429472656, 27.9279274726563], [112.644495878906, 27.9434401679688], [112.641224394531, 27.9288430000001], [112.649439726563, 27.8921950507813], [112.637345, 27.8838430000001], [112.614769316406, 27.9012673164062], [112.590667753906, 27.9324929023438], [112.594244414063, 27.9566945625], [112.54170046875, 27.9781984687501], [112.512735625, 27.9956716132813], [112.501624785156, 28.0228224921875], [112.487345, 28.033843], [112.472240019531, 28.0600392890625], [112.452345, 28.0584401679688], [112.442345, 28.0592458320313], [112.414686308594, 28.0570217109375], [112.400960722656, 27.9669460273438], [112.362345, 27.9700490546876], [112.327345, 27.9672365546875], [112.292345, 27.9700490546876], [112.252345, 27.9668337226563], [112.222345, 27.9692458320313], [112.207345, 27.9680397773438], [112.192020292969, 27.9692702460938], [112.173460722656, 27.9477272773438], [112.151917753906, 27.9291677070313], [112.1527746875, 27.9184889960938], [112.12197390625, 27.9092140937501], [112.095460234375, 27.8944216132813], [112.08271609375, 27.9092140937501], [112.069149199219, 27.9209035468751], [111.997345, 27.913843], [111.981656523438, 27.952798078125], [111.96170046875, 27.96819846875], [111.957345, 27.973843], [111.94470828125, 27.9968971992188], [111.900987578125, 27.976040265625], [111.897345, 28.023843], [111.904483671875, 28.0287721992188], [111.913529082031, 28.0691213203126], [111.898206816406, 28.1056008125], [111.923260527344, 28.1379274726563], [111.935513945313, 28.1856740546875], [111.953260527344, 28.1979274726563], [111.965513945313, 28.2156740546875], [111.977345, 28.223843], [111.993531523438, 28.2276564765625], [112.006939726563, 28.2494167304688], [112.063531523438, 28.2576564765625], [112.091158476563, 28.2700295234375], [112.128834257813, 28.2776564765625], [112.141158476563, 28.2576564765625], [112.163531523438, 28.2500295234376], [112.184959746094, 28.2349855781251], [112.211539335938, 28.2432643867187], [112.229471464844, 28.2141603828125], [112.271158476563, 28.2500295234376], [112.31271609375, 28.2641921210938], [112.317345, 28.283843], [112.34279421875, 28.2779470039063], [112.351832304688, 28.2896584296875], [112.365213652344, 28.2876808906251], [112.40298953125, 28.29819846875], [112.439205351563, 28.3200466132813], [112.481707792969, 28.3137648750001], [112.52205203125, 28.32962425], [112.551793242188, 28.32522971875], [112.588878203125, 28.417309796875], [112.605640898438, 28.4302468085938], [112.62170046875, 28.46948753125], [112.647345, 28.483843], [112.673487578125, 28.4792946601563], [112.653355742188, 28.445044171875], [112.672899199219, 28.4293971992187], [112.681790800781, 28.4082888007813], [112.693023710938, 28.3992971015625], [112.69166140625, 28.388344953125], [112.71341921875, 28.3791774726563], [112.701678496094, 28.3592018867188], [112.704832792969, 28.333843]]]] } }, { "type": "Feature", "properties": { "name": "天心区" }, "geometry": { "type": "MultiPolygon", "coordinates": [[[[112.967345, 28.203843], [112.967345, 28.1938430000001], [112.977345, 28.1938430000001], [112.98197390625, 28.15847190625], [113.002782011719, 28.1291237617188], [112.997345, 28.0738430000001], [112.987298613281, 28.0539821601563], [112.971954375, 28.0614748359376], [112.953985625, 28.047202375], [112.937345, 28.0438430000001], [112.929888945313, 28.0463869453125], [112.924801054688, 28.0961525703125], [112.944801054688, 28.1163869453125], [112.947345, 28.133843], [112.96197390625, 28.19921409375], [112.967345, 28.203843]]]] } }, { "type": "Feature", "properties": { "name": "望城区" }, "geometry": { "type": "MultiPolygon", "coordinates": [[[[112.887345, 27.983843], [112.883922148438, 27.9716506171875], [112.875152617188, 27.9804201484376], [112.887345, 27.983843]]], [[[112.947345, 28.013843], [112.957345, 28.013843], [112.957345, 28.0038430000001], [112.947345, 28.0038430000001], [112.947345, 28.013843]]], [[[112.811429472656, 28.0450954414063], [112.7926965625, 28.0273952460938], [112.777345, 28.033843], [112.777345, 28.0438430000001], [112.767345, 28.0438430000001], [112.767345, 28.053843], [112.777345, 28.053843], [112.811429472656, 28.0450954414063]]], [[[112.947345, 28.013843], [112.923826933594, 28.0241555], [112.934002714844, 27.9879445625001], [112.902923613281, 27.9770119453125], [112.887345, 27.983843], [112.877298613281, 28.0037038398438], [112.861353789063, 27.9959181953126], [112.85062625, 28.01712425], [112.830704375, 28.0272023750001], [112.809298125, 28.0698146796876], [112.777345, 28.0738430000001], [112.772899199219, 28.0793971992188], [112.759251738281, 28.0903249335937], [112.693836699219, 28.0821877265625], [112.642738066406, 28.1195143867188], [112.616378203125, 28.116235578125], [112.602899199219, 28.1222731757813], [112.622899199219, 28.1382888007813], [112.634547148438, 28.1921291328125], [112.69072390625, 28.2158010078125], [112.701790800781, 28.2793971992188], [112.71334109375, 28.2886428046875], [112.701678496094, 28.3084841132813], [112.704832792969, 28.333843], [112.701678496094, 28.3592018867188], [112.71341921875, 28.3791774726563], [112.69166140625, 28.388344953125], [112.693023710938, 28.3992971015625], [112.681790800781, 28.4082888007813], [112.672899199219, 28.4293971992187], [112.653355742188, 28.445044171875], [112.673487578125, 28.4792946601563], [112.647345, 28.483843], [112.6640246875, 28.5171047187501], [112.677345, 28.523843], [112.726019316406, 28.5118874335938], [112.771429472656, 28.5497585273438], [112.787345, 28.553843], [112.791978789063, 28.5265724921876], [112.812857695313, 28.5296584296875], [112.825264921875, 28.5135842109375], [112.862857695313, 28.5080275703125], [112.876951933594, 28.5262892890625], [112.937642851563, 28.5173220039063], [112.977345, 28.523843], [112.956361113281, 28.4704665351563], [112.992608671875, 28.4651100898438], [113.037345, 28.4938430000001], [113.044366484375, 28.478169171875], [113.022215605469, 28.4645192695313], [113.011844511719, 28.4204885078126], [112.98048953125, 28.4098024726563], [112.984154082031, 28.3980373359375], [112.977345, 28.393843], [112.951158476563, 28.3800295234375], [112.943531523438, 28.3576564765626], [112.905191679688, 28.3445900703125], [112.943531523438, 28.3000295234375], [112.957345, 28.2738430000001], [112.877564726563, 28.2657057929688], [112.86271609375, 28.2484719062501], [112.838590117188, 28.2276833320313], [112.852764921875, 28.1890822578126], [112.850970488281, 28.166723859375], [112.892847929688, 28.1700881171875], [112.891781035156, 28.1568215156251], [112.947345, 28.133843], [112.944801054688, 28.1163869453125], [112.924801054688, 28.0961525703125], [112.929888945313, 28.0463869453125], [112.937345, 28.0438430000001], [112.943985625, 28.030483625], [112.947345, 28.013843]]], [[[112.787345, 28.553843], [112.790767851563, 28.5660353828125], [112.799537382813, 28.5572658515626], [112.787345, 28.553843]]]] } }, { "type": "Feature", "properties": { "name": "雨花区" }, "geometry": { "type": "MultiPolygon", "coordinates": [[[[113.110335722656, 28.1780397773438], [113.087345, 28.173843], [113.087345, 28.183843], [113.097345, 28.183843], [113.110335722656, 28.1780397773438]]], [[[113.032469511719, 28.1962282539063], [113.077345, 28.173843], [113.064969511719, 28.1489455390626], [113.079671660156, 28.1188430000001], [113.0674621875, 28.093843], [113.075269804688, 28.0778517890626], [113.060704375, 28.070483625], [113.05279421875, 28.043071515625], [113.043336210938, 28.0617678046875], [113.031954375, 28.0562111640626], [113.013985625, 28.070483625], [112.997345, 28.0738430000001], [113.002782011719, 28.1291237617188], [112.98197390625, 28.15847190625], [112.977345, 28.1938430000001], [113.002242460938, 28.1814675117188], [113.032469511719, 28.1962282539063]]]] } }, { "type": "Feature", "properties": { "name": "岳麓区" }, "geometry": { "type": "MultiPolygon", "coordinates": [[[[112.96197390625, 28.19921409375], [112.947345, 28.133843], [112.891781035156, 28.1568215156251], [112.892847929688, 28.1700881171875], [112.850970488281, 28.166723859375], [112.852764921875, 28.1890822578126], [112.838590117188, 28.2276833320313], [112.86271609375, 28.2484719062501], [112.877564726563, 28.2657057929688], [112.957345, 28.2738430000001], [112.963985625, 28.260483625], [112.967345, 28.203843], [112.96197390625, 28.19921409375]]]] } },{ "type": "Feature", "properties": { "name": "高新区" }, "geometry": { "type": "MultiPolygon", "coordinates": [[[[112.899099,28.222449],[112.90119,28.223776],[112.900096,28.224317],[112.872801,28.220848],[112.867989,28.208591],[112.874332,28.205851],[112.88097,28.213246],[112.900843,28.216644],[112.914916,28.21518],[112.899099,28.222449]]]] } }, { "type": "Feature", "properties": { "name": "芙蓉区" }, "geometry": { "type": "MultiPolygon", "coordinates": [[[[113.106246367188, 28.2070021796875], [113.097345, 28.183843], [113.087345, 28.183843], [113.087345, 28.173843], [113.077345, 28.173843], [113.032469511719, 28.1962282539063], [113.002242460938, 28.1814675117188], [112.977345, 28.1938430000001], [112.967345, 28.1938430000001], [112.967345, 28.203843], [112.984801054688, 28.2063869453125], [112.999888945313, 28.2212990546875], [113.047345, 28.223843], [113.106246367188, 28.2070021796875]]]] } }, { "type": "Feature", "properties": { "name": "浏阳市" }, "geometry": { "type": "MultiPolygon", "coordinates": [[[[113.257345, 28.0038430000001], [113.257345, 27.993843], [113.247345, 27.993843], [113.247345, 28.0038430000001], [113.257345, 28.0038430000001]]], [[[113.257345, 28.0038430000001], [113.257345, 28.013843], [113.247345, 28.013843], [113.242799101563, 28.0195217109375], [113.227345, 28.0176003242188], [113.212342558594, 28.0194655585938], [113.167345, 28.013843], [113.173079863281, 28.0281081367188], [113.182122832031, 28.0614626289063], [113.202345, 28.0579811835938], [113.212345, 28.0597048164063], [113.233690214844, 28.0560280585937], [113.229959746094, 28.0776979804688], [113.274774199219, 28.0499611640625], [113.297345, 28.0438430000001], [113.302779570313, 28.0311452460938], [113.320343046875, 28.039790265625], [113.297345, 28.0438430000001], [113.309722929688, 28.0582106757813], [113.33271609375, 28.06847190625], [113.414461699219, 28.13608909375], [113.401146269531, 28.1599513984375], [113.364215117188, 28.1569850898438], [113.34271609375, 28.1712404609375], [113.367860136719, 28.1929030585938], [113.283038359375, 28.1860866523438], [113.27271609375, 28.2092140937501], [113.261693144531, 28.2289723945313], [113.283460722656, 28.2477272773438], [113.30197390625, 28.2892140937501], [113.319500761719, 28.3043166328125], [113.333116484375, 28.3642458320313], [113.328912382813, 28.416577375], [113.361229277344, 28.4444216132813], [113.403204375, 28.4631496406251], [113.4019153125, 28.4791896796876], [113.49271609375, 28.5184719062501], [113.497345, 28.543843], [113.513260527344, 28.5397585273438], [113.542345, 28.5275417304688], [113.572847929688, 28.5403542304688], [113.593682890625, 28.510180890625], [113.641007109375, 28.4775051093751], [113.664539824219, 28.4434206367188], [113.710601835938, 28.4240749335938], [113.725513945313, 28.4456740546875], [113.807113066406, 28.4666139960938], [113.843629179688, 28.5338039375], [113.882542753906, 28.5174587226562], [113.901429472656, 28.5297585273438], [113.943260527344, 28.5379274726563], [113.981969023438, 28.5679274726563], [114.003260527344, 28.5597585273438], [114.013016386719, 28.545630109375], [114.037345, 28.5510842109375], [114.052386503906, 28.5477126289062], [114.077345, 28.553843], [114.09170046875, 28.5481984687501], [114.12298953125, 28.53948753125], [114.16170046875, 28.5081984687501], [114.210765410156, 28.4945363593751], [114.214066191406, 28.4721877265625], [114.170611601563, 28.4386452460938], [114.196324492188, 28.4281227851563], [114.21170046875, 28.40819846875], [114.24298953125, 28.39948753125], [114.25170046875, 28.38819846875], [114.257345, 28.3838430000001], [114.251688261719, 28.3691262031251], [114.253607207031, 28.3537013984376], [114.235972929688, 28.3118532539063], [114.212899199219, 28.2982888007813], [114.19166140625, 28.2893410468751], [114.193023710938, 28.2783888984376], [114.181790800781, 28.2693971992188], [114.172899199219, 28.2582888007813], [114.141790800781, 28.2493971992188], [114.086221953125, 28.179946515625], [114.062345, 28.1769777656251], [114.038626738281, 28.1799269843751], [113.987640410156, 28.1653493476563], [114.003011503906, 28.1392018867188], [114.001004667969, 28.1230593085938], [114.032899199219, 28.0793971992188], [114.037345, 28.063843], [114.017928496094, 28.0367507148437], [113.964469023438, 28.0473146796875], [113.952345, 28.0158791328125], [113.926761503906, 28.0209352851563], [113.907345, 27.993843], [113.852347441406, 28.0007131171875], [113.841846953125, 27.975796125], [113.812345, 27.9794655585938], [113.798472929688, 27.977739484375], [113.782899199219, 27.9582888007813], [113.758785429688, 27.948130109375], [113.732908964844, 27.91581565625], [113.727345, 27.8838430000001], [113.684608183594, 27.8770827460938], [113.656627226563, 27.8799343085938], [113.596224394531, 27.9145314765625], [113.575279570313, 27.8893190742188], [113.562806425781, 27.9593044257813], [113.529420195313, 27.9683815742188], [113.512806425781, 27.9483815742188], [113.481883574219, 27.9393044257813], [113.472806425781, 27.9283815742187], [113.455201445313, 27.913755109375], [113.413787871094, 27.8957936835938], [113.402806425781, 27.8583815742188], [113.357345, 27.8538430000001], [113.317261992188, 27.8641286445313], [113.291998320313, 27.8805812812501], [113.283260527344, 27.8679274726563], [113.267345, 27.863843], [113.274647246094, 27.8935720039063], [113.271073027344, 27.9095143867188], [113.284586210938, 27.918843], [113.258531523438, 27.9368312812501], [113.271380644531, 27.9941506171875], [113.257345, 28.0038430000001]]]] } }] });
    var chartmap = echarts.init(document.getElementById('mid-map'));
    //地图标点颜色
    var pointColor = ['#e9ed5e', '#eb94d5', '#28da21', '#dc7b39', '#07d9de', '#09dbdd', '#ef6b88'];
    
    //电梯数量分布情况
    var mapData = [
        { name: '长沙县', value: 0, bfb: 0 },
        { name: '开福区', value: 0, bfb: 0 },
        { name: '宁乡县', value: 0, bfb: 0 },
        { name: '天心区', value: 0, bfb: 0 },
        { name: '望城区', value: 0, bfb: 0 },
        { name: '雨花区', value: 0, bfb: 0 },
        { name: '岳麓区', value: 0, bfb: 0 },
        { name: '高新区', value: 1000, bfb: 100 },
        { name: '芙蓉区', value: 0, bfb: 0 },
        { name: '浏阳市', value: 0, bfb: 0 },
    ];

    //地图标点坐标
    var geoCoordMap = {
        '长沙县': [113.181954375, 28.3079811835938],
        '开福区': [113.001803007813, 28.309165265625],
        '宁乡县': [112.401790800781, 28.1593971992188],
        '天心区': [112.96197390625, 28.09847190625],
        '望城区': [112.777345, 28.3838430000001],
        '雨花区': [113.037345, 28.208843],
        '岳麓区': [112.932764921875, 28.1890822578126],
        '高新区': [112.88097,28.217246],
        '芙蓉区': [113.032242460938, 28.1314675117188],
        '浏阳市': [113.667345, 28.2276003242188]
    };
    
    

    var convertLineData = function (data) {
        var res = [];
        for (var i = 0; i < data.length; i++) {
            var dataItem = data[i];
            var coordS = dataItem.lineS; //线起点
            var coordM = dataItem.lineM; //线中间点
            var coordE = dataItem.lineE; //线尾点
            if (coordS && coordM && coordE) {
                res.push({
                    coords: [coordS, coordM, coordE]
                });
            }
        }
        return res;
    };

    // 初始坐标lineS 中坐标lineM 末坐标lineE
    var json = {
        data: [
            { areaName: '岳麓区', lineS: [112.932764921875, 28.1890822578126], lineM: [112.732764921875, 28.0590822578126], lineE: [112.532764921875, 27.8790822578126] },
            { areaName: '高新区', lineS: [112.88097,28.217246], lineM: [112.932764921875, 28.4090822578126], lineE: [112.932764921875, 28.6980822578000] },
            { areaName: '天心区', lineS: [112.96197390625, 28.09847190625], lineM: [112.96197390625, 27.99847190625], lineE: [112.96197390625, 27.89847190625] },
            { areaName: '雨花区', lineS: [113.037345, 28.208843], lineM: [113.437345, 28.408843], lineE: [113.637345, 28.698000] },
        ]
    };
    var jsondata = json.data;
    
  //根据查询结果，动态赋值
    for (var i = 0; i < mapValueData.length; i++) {
	     var area = mapValueData[i].companyName;
         var etotal = mapValueData[i].etotal;
         if(area == "高新区"){
        	 mapData[7].value = etotal;
         }
               	 
    } 
    
    var convertData = function (data) {
        // 需要画线区的初始坐标和末坐标
        var yueluS = jsondata[0].lineS.toString();
        var yueluE = jsondata[0].lineE.toString().split(',');
        var gaoxinS = jsondata[1].lineS.toString();
        var gaoxinE = jsondata[1].lineE.toString().split(',');
        var tianxinS = jsondata[2].lineS.toString();
        var tianxinE = jsondata[2].lineE.toString().split(',');
        var yuhuaS = jsondata[3].lineS.toString();
        var yuhuaE = jsondata[3].lineE.toString().split(',');
        var res = [];
        for (var i = 0; i < data.length; i++) {
            var geoCoord = geoCoordMap[data[i].name];
            if (geoCoord == gaoxinS) {
                res.push({
                    name: data[i].name,
                    value: gaoxinE.concat(data[i].value)
                });
            } else if (geoCoord == tianxinS) {
                res.push({
                    name: data[i].name,
                    value: tianxinE.concat(data[i].value)
                });
            } else if (geoCoord == yuhuaS) {
                res.push({
                    name: data[i].name,
                    value: yuhuaE.concat(data[i].value)
                });
            } else if (geoCoord == yueluS) {
                res.push({
                    name: data[i].name,
                    value: yueluE.concat(data[i].value)
                });
            }else {
                res.push({
                    name: data[i].name,
                    value: geoCoord.concat(data[i].value)
                });
            }
        }
        return res;
    };



    optionMap = {
        // backgroundColor: '#020933',
        title: {
            text: '电梯分布数量及比例',
            textStyle: {
                color: '#dfd915'
            }
        },

        tooltip: {
            trigger: 'item',
            formatter: function (params) {
                if (typeof (params.value)[2] == "undefined") {
                    return params.name + ' : ' + params.value + "(" + params.data.bfb + "%)";
                } else {
                    return params.name + ' : ' + params.value[2] + "(" + params.data.bfb[2] + "%)";
                }
            }
        },
        visualMap: {
            show: false,
            min: 0,
            max: 10000,
            left: 'left',
            top: 'bottom',
            text: ['高', '低'], // 文本，默认为数值文本
            calculable: true,
            seriesIndex: [1],
            inRange: {
                color: ['#999', '#389bb7','#e9ed5e', '#eb94d5', '#28da21', '#dc7b39', '#07d9de', '#09dbdd', '#ef6b88']
            }
        },
        geo: {
            show: true,
            map: '长沙',
            label: {
                normal: {
                    show: false
                },
                emphasis: {
                    show: false
                }
            },
            regions: [{
                name: '岳麓区',
                selected: true
                }],
            zoom: 1.2,
            roam: true,
            itemStyle: {//地图参数设置
                normal: {
                    borderColor: '#bebdc5',
                    borderWidth: 2,
                    shadowColor: 'rgba(0, 0, 0, 1)',
                    shadowBlur: 10,
                    shadowOffsetX: 10
                },
                emphasis: {
                    areaColor: 'rgb(15, 72, 188)'//选择地图颜色
                }
            }
        },
        series: [

            {
                name: 'light',
                type: 'effectScatter',
                coordinateSystem: 'geo',
                data: convertData(mapData),
                symbolSize: 10,
                zlevel: 10,
                label: {
                    normal: {
                        formatter: function (params) {
                            return params.name + ' \n' + params.value[2];
                        },
                        position: 'bottom',
                        show: true,
                        color: '#fff'
                    },
                    emphasis: {
                        show: true
                    }
                },
                itemStyle: {
                    normal: {
                        color: function (params) {
                            var num = pointColor.length;
                            return pointColor[params.dataIndex % num]
                        }
                    }
                }

            },

            {
                type: 'map',
                map: '长沙',
                geoIndex: 0,
                aspectScale: 1, //长宽比
                showLegendSymbol: false, // 存在legend时显示
                label: {
                    normal: {
                        show: false
                    },
                    emphasis: {
                        show: false,
                        textStyle: {
                            color: '#fff'
                        }
                    }
                },
                roam: true,
                itemStyle: {
                    normal: {
                        areaColor: '#031525',
                        borderColor: '#FFFFFF'
                    },
                    emphasis: {
                        areaColor: 'rgb(15, 72, 188)'
                    }
                },
                animation: false,
                data: mapData
            },
            {
                name: 'lines',
                type: 'lines',
                zlevel: 2,
                silent: true, //不响应鼠标点击或事件
                effect: {
                    show: false //关闭特效
                },
                tooltip: {
                    show: false
                },
                polyline: true, //支持多点连线
                lineStyle: {
                    normal: {
                        color: '#fff',
                        width: 2,
                        opacity: 0.9,
                        curveness: 0
                    }
                },
                data: convertLineData(jsondata)
            },

        ]
    };
    chartmap.setOption(optionMap);
    //根据窗口的大小变动图表
    window.onresize = function () {
        chartmap.resize();
    };
}